<!DOCTYPE html>
<html lang="en">
<head>
  <title>虚拟机管理系统</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link rel="stylesheet" type="text/css" href="/media/css/tree.css"/>
  <link rel="stylesheet" href="/media/css/reset.css" type="text/css" media="all">
  <link rel="stylesheet" href="/media/css/style.css" type="text/css" media="all">
  <script type="text/javascript" src="/media/js/jquery-1.4.2.min.js" ></script>
  <script type="text/javascript" src="/media/js/cufon-yui.js"></script>
  <script type="text/javascript" src="/media/js/cufon-replace.js"></script>
  <script type="text/javascript" src="/media/js/roundabout.js"></script>
  <script type="text/javascript" src="/media/js/roundabout_shapes.js"></script>
  <script type="text/javascript" src="/media/js/gallery_init.js"></script>

  <script type="text/javascript" src="/media/dtree/dtree.js"></script>

 

</head>

<body>
  <!-- header -->
  <header>
    <div class="container">
    	<h1><a href="../home">虚拟机管理系统</a></h1>
      <nav>
        <ul>
        	<li><a href="/home">主界面</a></li>
          <li><a href="/res" class="current">资源视图</a></li>
          <li><a href="/work">应用视图</a></li>
          <li><a href="/newvirt">新建虚拟机</a></li>
        </ul>
      </nav>
    </div>
	</header>
  <!-- #gallery -->
  
  <div class="main-box">
    <div class="container1">
      <div class="inside">
        <div class="wrapper">
   	<!-- aside -->
          <aside>
            <h3>虚拟机集群架构</h3>
            <div class="dtree" id="treeDiv">
 	          <script type="text/javascript">
                                  //生成新的树，ajax方式获取最新tree，每个json item表示一个节点
	          tree = new dTree('tree');   //参数tree，表示生成的html代码中id的标记，不影响功能
             tree.add(0,-1,'Management','mgtresource','','iresource');//树根
	          $("#treeDiv").html(tree.toString());
             function getTree(){ 
                 //var stime = new Date();
                 $.getJSON('/ajax/tree',function(data){
                   tree = new dTree('tree');   //参数tree，表示生成的html代码中id的标记，不影响功能
                   tree.add(0,-1,'Management','../mgtresource','','ifr');     //树根
                                                   //遍历JSON中的每个entry
                   $.each(data,function(entryIndex,entry){
                      tree.add(entry['id'], entry['pid'], entry['name'],"../" + entry['url'],'','ifr','/media/dtree/img/base.gif','/media/dtree/img/base.gif');
                                                   });
                   $("#treeDiv").html(tree.toString());
                                              });
                 //var etime = new Date();
                 //d_date=etime.getTime()-stime.getTime();
 		           //setInterval("getTree()", 3000);
                                 }
	         setInterval("getTree()",3000 );
            //getTree();
            </script>
           </div>
            <!-- .tree -->
          </aside>
          <!-- data -->
 
          <section id="content">
             <iframe src="/mgtresource" name="ifr"></iframe>
          </section>
        </div>
      </div>
    </div>
  </div>
  <!-- footer -->
  <footer>
    <div class="container">
    	<div class="wrapper">
        <div class="fleft">Copyright - 信息工程研究所</div>
        <div class="fright"><a href="http://iiecas.cn/" target="_blank">信息工程研究所</a> iiecas.cn</div>
      </div>
    </div>
  </footer>
  <script type="text/javascript"> Cufon.now(); </script>
</body>
</html>
